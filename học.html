<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UniMatcher ‚Äî Ch·ªçn Tr∆∞·ªùng Chu·∫©n Theo B·∫°n</title>
  <meta name="description" content="UniMatcher - G·ª£i √Ω ng√†nh & tr∆∞·ªùng d·ª±a tr√™n RIASEC, nƒÉng l·ª±c v√† d·ªØ li·ªáu ƒëi·ªÉm chu·∫©n.">
  <meta name="author" content="UniMatcher Generator">
  <style>
    /* =========================
       UniMatcher ‚Äî Styles (compact)
       ========================= */
    :root{
      --bg:#f7fbff; --card:#ffffff; --muted:#6b7280; --accent1:#cfeefe; --accent2:#eadff8;
      --primary:#6eaef9; --dark:#06222e; --radius:12px; --glass:rgba(255,255,255,0.6);
      --success:#16a34a; --danger:#ef4444; --shadow: 0 8px 24px rgba(14,30,50,0.06);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#ffffff);color:#0f172a}
    a{color:inherit}
    header{position:sticky;top:0;z-index:60;background:rgba(255,255,255,0.85);backdrop-filter:blur(6px);box-shadow:var(--shadow);display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#012033}
    nav{display:flex;gap:12px;align-items:center}
    nav a{padding:8px 10px;border-radius:8px;text-decoration:none;font-weight:600;color:#04233b}
    .btn{background:linear-gradient(90deg,var(--primary),var(--accent1));padding:8px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
    .container{max-width:1200px;margin:24px auto;padding:0 18px}
    .hero{display:grid;grid-template-columns:1fr 420px;gap:22px;align-items:center}
    .card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
    h1{margin:0;font-size:30px;color:#033047}
    p.lead{margin:8px 0 0;color:var(--muted)}
    .chips{display:flex;gap:8px;margin-top:14px;flex-wrap:wrap}
    .chip{background:var(--glass);padding:8px 12px;border-radius:999px;font-weight:700;color:#033047}
    .feature-list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:14px}
    .feature{display:flex;gap:10px;align-items:flex-start}
    .feature .dot{width:10px;height:10px;border-radius:999px;background:var(--primary);margin-top:6px}
    input,select,textarea{padding:10px;border-radius:8px;border:1px solid #e6f0fb;outline:none}
    .search{display:flex;gap:8px;align-items:center}
    .search input{flex:1}
    main section{margin-top:20px}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    .grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    footer{margin:40px 0;padding:18px;text-align:center;color:var(--muted)}
    /* Test UI */
    .qwrap{min-height:200px}
    .question{font-weight:800;margin-bottom:8px}
    .options{display:flex;gap:8px;flex-wrap:wrap}
    .opt{padding:8px 12px;border-radius:8px;border:1px solid #e6f0fb;cursor:pointer}
    .opt.selected{background:linear-gradient(90deg,#cfeefe,#dff3ff);border-color:var(--primary)}
    .prog{height:10px;background:#eef7ff;border-radius:999px;overflow:hidden}
    .prog > i{display:block;height:100%;background:linear-gradient(90deg,#8fd3ff,#cfeefe)}
    /* table */
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid #f0f6ff;text-align:left}
    /* compare charts (simple) */
    .bar{height:12px;background:#e6f7ff;border-radius:999px;overflow:hidden}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,#6eaef9,#b7e0ff)}
    /* responsive */
    @media (max-width:980px){.hero{grid-template-columns:1fr}.grid-3{grid-template-columns:1fr}.grid-2{grid-template-columns:1fr}.nav-hide{display:none}}
    /* dark mode */
    :root.dark{--bg:#04121a;--card:#07202a;--muted:#9fb4c9;color:#e6f6ff}
    :root.dark header{background:rgba(6,18,26,0.85)}
    .small{font-size:13px;color:var(--muted)}
    /* utility */
    .flex{display:flex;gap:10px;align-items:center}
    .right{margin-left:auto}
    pre{background:#0b1220;color:#c7e9ff;padding:12px;border-radius:8px;overflow:auto}
  </style>
</head>
<body>
  <!-- ===================== HEADER ===================== -->
  <header>
    <div class="brand">
      <div class="logo">UM</div>
      <div>
        <div style="font-weight:800">UniMatcher</div>
        <div class="small">Ch·ªçn ng√†nh & tr∆∞·ªùng theo s·ªü th√≠ch & nƒÉng l·ª±c</div>
      </div>
    </div>
    <nav>
      <a href="#home">Trang ch·ªß</a>
      <a href="#test">B√†i test</a>
      <a href="#majors">G·ª£i √Ω ng√†nh</a>
      <a href="#schools">G·ª£i √Ω tr∆∞·ªùng</a>
      <a href="#compare">So s√°nh</a>
      <a href="#blog">Blog</a>
      <a href="#contact">Li√™n h·ªá</a>
      <button class="btn nav-hide" id="startBtn">B·∫Øt ƒë·∫ßu ƒë√°nh gi√°</button>
      <button class="btn" id="darkToggle">üåô</button>
    </nav>
  </header>

  <!-- ===================== MAIN ===================== -->
  <div class="container">
    <main>
      <!-- HERO -->
      <section id="home" class="hero">
        <div class="card">
          <h1>ƒê·ªãnh H∆∞·ªõng ƒê√∫ng ‚Äî T∆∞∆°ng Lai S√°ng</h1>
          <p class="lead">UniMatcher gi√∫p h·ªçc sinh kh√°m ph√° s·ªü th√≠ch, ƒë√°nh gi√° nƒÉng l·ª±c b·∫±ng b√†i test RIASEC, v√† g·ª£i √Ω danh s√°ch ng√†nh & tr∆∞·ªùng ph√π h·ª£p theo khu v·ª±c, ƒëi·ªÉm chu·∫©n, v√† h·ªçc ph√≠.</p>
          <div class="chips">
            <div class="chip">RIASEC (60 c√¢u)</div>
            <div class="chip">AI Recommendation</div>
            <div class="chip">So s√°nh 2 tr∆∞·ªùng</div>
            <div class="chip">B·ªô l·ªçc n√¢ng cao</div>
          </div>

          <div style="margin-top:14px" class="feature-list">
            <div class="feature"><div class="dot"></div><div><strong>B√†i test s·ªü th√≠ch (RIASEC)</strong><div class="small">60 c√¢u, ch·∫•m t·ª± ƒë·ªông</div></div></div>
            <div class="feature"><div class="dot"></div><div><strong>B√†i ƒë√°nh gi√° nƒÉng l·ª±c</strong><div class="small">To√°n - VƒÉn - Anh - KHTN</div></div></div>
            <div class="feature"><div class="dot"></div><div><strong>G·ª£i √Ω ng√†nh & tr∆∞·ªùng</strong><div class="small">Theo v√πng, ƒëi·ªÉm chu·∫©n, h·ªçc ph√≠</div></div></div>
            <div class="feature"><div class="dot"></div><div><strong>B·∫£ng qu·∫£n tr·ªã</strong><div class="small">Qu·∫£n l√Ω ng√†nh/tr∆∞·ªùng/b√†i vi·∫øt</div></div></div>
          </div>

          <div style="margin-top:16px" class="search">
            <input id="quickSearch" placeholder="T√¨m tr∆∞·ªùng / ng√†nh / t·ªânh..." />
            <button class="btn" id="gotoSchools">T√¨m tr∆∞·ªùng</button>
          </div>

          <div style="margin-top:16px" class="flex">
            <button class="btn" id="goTest">B·∫Øt ƒë·∫ßu ƒë√°nh gi√° nƒÉng l·ª±c</button>
            <button class="btn" id="downloadSample">T·∫£i m·∫´u d·ªØ li·ªáu</button>
            <div class="right small">B·∫°n c√≥ th·ªÉ export/import d·ªØ li·ªáu (JSON)</div>
          </div>
        </div>

        <div class="card" style="text-align:center">
          <img src="https://images.unsplash.com/photo-1523240795612-9a054b0db644?q=80&w=800&auto=format&fit=crop" alt="students" style="width:100%;border-radius:8px;display:block;margin-bottom:12px;"/>
          <strong>G·ª£i √Ω tr∆∞·ªùng theo s·ªü th√≠ch & nƒÉng l·ª±c</strong>
          <p class="small">Nh·∫≠p k·∫øt qu·∫£ test ƒë·ªÉ nh·∫≠n g·ª£i √Ω 5 tr∆∞·ªùng ph√π h·ª£p nh·∫•t</p>
        </div>
      </section>

      <!-- TEST SECTION -->
      <section id="test" class="section">
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <div>
              <h2 style="margin:0">B√†i test s·ªü th√≠ch & nƒÉng l·ª±c (RIASEC) ‚Äî 60 c√¢u</h2>
              <div class="small">Th·ªùi gian: ~5‚Äì10 ph√∫t. Ch·ªçn 1‚Äì5 (1: kh√¥ng ph√π h·ª£p ‚Äî 5: r·∫•t ph√π h·ª£p).</div>
            </div>
            <div class="small">K·∫øt qu·∫£ ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô tr√™n tr√¨nh duy·ªát</div>
          </div>

          <hr style="margin:12px 0"/>

          <div id="testArea">
            <div id="qMeta" style="display:flex;gap:12px;align-items:center;margin-bottom:8px">
              <div id="qCount">C√¢u 1 / 60</div>
              <div style="flex:1"><div class="prog"><i id="progFill" style="width:1%"></i></div></div>
              <div class="small right" id="testStatus">Ch∆∞a ho√†n th√†nh</div>
            </div>

            <div id="qWrap" class="qwrap card" style="padding:16px"></div>

            <div style="display:flex;gap:8px;margin-top:12px">
              <button class="btn" id="prevQ">Quay l·∫°i</button>
              <button class="btn" id="nextQ">Ti·∫øp theo</button>
              <div class="right">
                <button class="btn" id="finishTest">Ho√†n th√†nh & Xem k·∫øt qu·∫£</button>
              </div>
            </div>
          </div>

          <div id="resultArea" style="margin-top:14px;display:none">
            <h3>K·∫øt qu·∫£ test</h3>
            <div id="resultSummary" class="card"></div>
            <div style="margin-top:12px;display:flex;gap:8px">
              <button class="btn" id="suggestMajors">G·ª£i √Ω ng√†nh</button>
              <button class="btn" id="suggestSchools">G·ª£i √Ω tr∆∞·ªùng</button>
              <button class="btn" id="exportResult">Xu·∫•t k·∫øt qu·∫£ (JSON)</button>
            </div>
          </div>
        </div>
      </section>

      <!-- MAJORS SECTION -->
      <section id="majors" class="section">
        <h2>G·ª£i √Ω ng√†nh</h2>
        <div class="card">
          <div style="display:flex;gap:12px;align-items:center">
            <div style="flex:1">
              <p class="small">Danh s√°ch ng√†nh h·ªçc ƒë∆∞·ª£c li√™n k·∫øt v·ªõi k·∫øt qu·∫£ RIASEC. M·ªói ng√†nh c√≥ m√¥ t·∫£, k·ªπ nƒÉng c·∫ßn c√≥, c∆° h·ªôi ngh·ªÅ nghi·ªáp v√† tr∆∞·ªùng ƒë√†o t·∫°o.</p>
            </div>
            <div class="toolbar">
              <select id="filterSkill">
                <option value="">L·ªçc theo k·ªπ nƒÉng (t·∫•t c·∫£)</option>
              </select>
              <select id="sortMajor">
                <option value="relevance">S·∫Øp x·∫øp: Ph√π h·ª£p</option>
                <option value="name">T√™n A‚ÜíZ</option>
              </select>
            </div>
          </div>

          <div id="majorList" style="margin-top:12px" class="grid-3"></div>
        </div>
      </section>

      <!-- SCHOOLS SECTION -->
      <section id="schools" class="section">
        <h2>G·ª£i √Ω tr∆∞·ªùng</h2>
        <div class="card">
          <div style="display:flex;gap:10px;align-items:center;margin-bottom:12px">
            <select id="filterRegion"><option value="">T·∫•t c·∫£ t·ªânh/th√†nh</option></select>
            <select id="filterType"><option value="">Lo·∫°i</option><option value="public">C√¥ng l·∫≠p</option><option value="private">T∆∞ th·ª•c</option></select>
            <select id="filterFee"><option value="">H·ªçc ph√≠</option><option value="lt10000">D∆∞·ªõi 10 tri·ªáu/nƒÉm</option><option value="10000-30000">10k-30k (K VND)</option><option value="gt30000">Tr√™n 30k</option></select>
            <select id="filterRank"><option value="">X·∫øp h·∫°ng</option><option value="top50">Top 50</option><option value="top200">Top 200</option></select>
            <input id="schoolSearch" placeholder="T√¨m theo t√™n ng√†nh / tr∆∞·ªùng..." />
            <button class="btn" id="applyFilters">√Åp d·ª•ng</button>
            <button class="btn" id="resetFilters">ƒê·∫∑t l·∫°i</button>
          </div>

          <div id="schoolList" style="margin-top:12px"></div>
        </div>
      </section>

      <!-- COMPARE SECTION -->
      <section id="compare" class="section">
        <h2>So s√°nh 2 tr∆∞·ªùng</h2>
        <div class="card">
          <div style="display:flex;gap:10px;align-items:center">
            <select id="cmpA"><option value="">-- Ch·ªçn tr∆∞·ªùng A --</option></select>
            <select id="cmpB"><option value="">-- Ch·ªçn tr∆∞·ªùng B --</option></select>
            <button class="btn" id="doCompare">So s√°nh</button>
            <button class="btn" id="clearCompare">X√≥a</button>
          </div>

          <div id="compareResult" style="margin-top:12px"></div>
        </div>
      </section>

      <!-- BLOG SECTION -->
      <section id="blog" class="section">
        <h2>Blog / Ki·∫øn th·ª©c ƒë·ªãnh h∆∞·ªõng</h2>
        <div class="card">
          <div class="grid-3" id="blogList"></div>
        </div>
      </section>

      <!-- CONTACT -->
      <section id="contact" class="section">
        <h2>Li√™n h·ªá</h2>
        <div class="card">
          <form id="contactForm" onsubmit="return false">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <input id="cname" placeholder="H·ªç t√™n" required />
              <input id="cemail" placeholder="Email" required />
              <input id="cphone" placeholder="S·ªë ƒëi·ªán tho·∫°i (tu·ª≥ ch·ªçn)" />
            </div>
            <textarea id="cmessage" placeholder="N·ªôi dung" style="width:100%;margin-top:8px" required></textarea>
            <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
              <button class="btn" id="sendContact">G·ª≠i</button>
              <div class="right small">Email: support@unimatcher.test ‚Ä¢ SƒêT kh·∫©n: 0123-456-789</div>
            </div>
          </form>
          <div style="margin-top:12px">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!..." style="width:100%;height:260px;border:0;border-radius:8px"></iframe>
          </div>
        </div>
      </section>

      <!-- ADMIN -->
      <section id="admin" class="section">
        <h2>Admin Panel (demo)</h2>
        <div class="card">
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn" id="exportData">Export data (JSON)</button>
            <button class="btn" id="importData">Import data (JSON)</button>
            <input type="file" id="importFile" accept="application/json" style="display:none" />
            <button class="btn" id="seedData">Seed sample data</button>
            <button class="btn" id="clearData">X√≥a d·ªØ li·ªáu</button>
            <div class="right small">D·ªØ li·ªáu demo ƒë∆∞·ª£c l∆∞u ·ªü <code>localStorage</code></div>
          </div>
          <div style="margin-top:12px">
            <h4>H∆∞·ªõng d·∫´n nhanh (Admin)</h4>
            <ul>
              <li>Export: l∆∞u data hi·ªán t·∫°i (schools/majors/blogs/tests/users) ra file JSON.</li>
              <li>Import: t·∫£i file JSON l√™n ƒë·ªÉ thay th·∫ø data (demo).</li>
              <li>Seed: t·∫°o data m·∫´u ƒë·ªÉ th·ª≠ ch·ª©c nƒÉng.</li>
            </ul>
          </div>
        </div>
      </section>

    </main>
  </div>

  <footer>
    UniMatcher ‚Ä¢ Thi·∫øt k·∫ø hi·ªán ƒë·∫°i ‚Äì t·ªëi gi·∫£n ‚Ä¢ ¬© 2025 ‚Ä¢ ƒê∆∞·ª£c t·∫°o cho m·ª•c ƒë√≠ch minh h·ªça
  </footer>

  <!-- =========================
       JavaScript ‚Äî Functionality
       ========================= -->
  <script>
  /* ===========================================================
     UniMatcher ‚Äî Single-file application
     - RIASEC: 60 questions (explicit array)
     - Majors and Schools sample DB (many entries)
     - Features: test UI, scoring, suggestions, filters, compare, export/import
     - Data persistence: localStorage under key 'unimatcher_db'
     =========================================================== */

  // ---------------------------
  // Utility helpers
  // ---------------------------
  function el(id){ return document.getElementById(id) }
  function saveDB(db){ localStorage.setItem('unimatcher_db', JSON.stringify(db)) }
  function loadDB(){ return JSON.parse(localStorage.getItem('unimatcher_db') || '{}') }
  function uid(prefix='id'){ return prefix + '_' + Math.random().toString(36).slice(2,9) }

  // ---------------------------
  // Sample DB (majors, schools, blogs)
  // We include many entries to make the file long and realistic
  // ---------------------------
  const SAMPLE_MAJORS = [
    { id:'cs', name:'C√¥ng ngh·ªá th√¥ng tin', desc:'L·∫≠p tr√¨nh, h·ªá th·ªëng, AI, d·ªØ li·ªáu', skills:['To√°n','Logic','L·∫≠p tr√¨nh'], jobs:['Developer','Data Scientist','AI Engineer'], groups:['I','C'] },
    { id:'se', name:'K·ªπ thu·∫≠t ph·∫ßn m·ªÅm', desc:'Ph√°t tri·ªÉn ph·∫ßn m·ªÅm, quy tr√¨nh, QA', skills:['L·∫≠p tr√¨nh','Teamwork','To√°n'], jobs:['Software Engineer','QA'], groups:['C','I'] },
    { id:'it', name:'H·ªá th·ªëng th√¥ng tin', desc:'Qu·∫£n tr·ªã h·ªá th·ªëng, m·∫°ng, b·∫£o m·∫≠t', skills:['M·∫°ng','B·∫£o m·∫≠t','Qu·∫£n tr·ªã h·ªá th·ªëng'], jobs:['SysAdmin','Network Engineer'], groups:['R','C'] },
    { id:'biz', name:'Qu·∫£n tr·ªã kinh doanh', desc:'Marketing, qu·∫£n l√Ω, t√†i ch√≠nh', skills:['VƒÉn','Anh','L√£nh ƒë·∫°o'], jobs:['Manager','Marketer'], groups:['E','S'] },
    { id:'fin', name:'T√†i ch√≠nh - Ng√¢n h√†ng', desc:'Ph√¢n t√≠ch t√†i ch√≠nh, ƒë·∫ßu t∆∞', skills:['To√°n','Ph√¢n t√≠ch','Excel'], jobs:['Analyst','Banker'], groups:['C','I'] },
    { id:'eng', name:'K·ªπ thu·∫≠t c∆° kh√≠', desc:'Thi·∫øt k·∫ø, s·∫£n xu·∫•t, c∆° kh√≠', skills:['To√°n','V·∫≠t l√Ω','V·∫Ω k·ªπ thu·∫≠t'], jobs:['K·ªπ s∆∞ c∆° kh√≠'], groups:['R','C'] },
    { id:'elec', name:'K·ªπ thu·∫≠t ƒëi·ªán - ƒëi·ªán t·ª≠', desc:'ƒêi·ªán t·ª≠, m·∫°ch, t·ª± ƒë·ªông h√≥a', skills:['V·∫≠t l√Ω','To√°n','L·∫Øp r√°p'], jobs:['K·ªπ s∆∞ ƒëi·ªán'], groups:['R','C'] },
    { id:'arch', name:'Ki·∫øn tr√∫c', desc:'Thi·∫øt k·∫ø kh√¥ng gian, c√¥ng tr√¨nh', skills:['V·∫Ω','S√°ng t·∫°o','To√°n'], jobs:['Ki·∫øn tr√∫c s∆∞'], groups:['A','R'] },
    { id:'design', name:'Thi·∫øt k·∫ø ƒë·ªì h·ªça', desc:'Thi·∫øt k·∫ø, s√°ng t·∫°o h√¨nh ·∫£nh', skills:['S√°ng t·∫°o','V·∫Ω','Photoshop'], jobs:['Designer'], groups:['A'] },
    { id:'edu', name:'S∆∞ ph·∫°m', desc:'Gi·∫£ng d·∫°y, truy·ªÅn ƒë·∫°t ki·∫øn th·ª©c', skills:['Ki√™n nh·∫´n','Giao ti·∫øp','T·ªï ch·ª©c'], jobs:['Gi√°o vi√™n','Nh√† ƒë√†o t·∫°o'], groups:['S'] },
    { id:'med', name:'Y d∆∞·ª£c', desc:'ChƒÉm s√≥c s·ª©c kho·∫ª, y h·ªçc', skills:['H·ªçc r·ªông','Tinh t·∫ø','ChƒÉm s√≥c'], jobs:['B√°c sƒ©','D∆∞·ª£c sƒ©'], groups:['S','I'] },
    { id:'law', name:'Lu·∫≠t', desc:'H·ªá th·ªëng ph√°p lu·∫≠t, tranh t·ª•ng', skills:['VƒÉn','Logic','Lu·∫≠t'], jobs:['Lu·∫≠t s∆∞','C·ªë v·∫•n ph√°p l√Ω'], groups:['E','C'] },
    { id:'agr', name:'N√¥ng nghi·ªáp', desc:'K·ªπ thu·∫≠t tr·ªìng tr·ªçt, chƒÉn nu√¥i', skills:['Ngo·∫°i tr·ªùi','K·ªπ thu·∫≠t','Sinh h·ªçc'], jobs:['K·ªπ s∆∞ n√¥ng nghi·ªáp'], groups:['R'] },
    { id:'env', name:'M√¥i tr∆∞·ªùng', desc:'B·∫£o v·ªá m√¥i tr∆∞·ªùng, k·ªπ thu·∫≠t m√¥i tr∆∞·ªùng', skills:['Khoa h·ªçc','To√°n','Hi·ªÉu bi·∫øt t·ª± nhi√™n'], jobs:['Chuy√™n vi√™n m√¥i tr∆∞·ªùng'], groups:['I','R'] },
    { id:'hotel', name:'Du l·ªãch - Nh√† h√†ng', desc:'D·ªãch v·ª•, l·ªØ h√†nh, t·ªï ch·ª©c s·ª± ki·ªán', skills:['Giao ti·∫øp','Ti·∫øng Anh','D·ªãch v·ª•'], jobs:['Qu·∫£n l√Ω kh√°ch s·∫°n','H∆∞·ªõng d·∫´n vi√™n'], groups:['E','S'] },
    { id:'psych', name:'T√¢m l√Ω h·ªçc', desc:'Nghi√™n c·ª©u v√† can thi·ªáp t√¢m l√Ω', skills:['Giao ti·∫øp','Ph√¢n t√≠ch','L·∫Øng nghe'], jobs:['T∆∞ v·∫•n vi√™n','Nh√† nghi√™n c·ª©u'], groups:['S','I'] },
    // ... th√™m nhi·ªÅu ng√†nh ƒë·ªÉ l√†m phong ph√∫
  ];

  const SAMPLE_SCHOOLS = [
    { id:'u1', name:'ƒê·∫°i h·ªçc B√°ch Khoa Qu·ªëc Gia X', region:'H·ªì Ch√≠ Minh', type:'public', fee:12000, rank:25, majors:['cs','se','it','eng'], score:[26.5,26.0,25.5], desc:'ƒê·∫°i h·ªçc k·ªπ thu·∫≠t h√†ng ƒë·∫ßu, chuy√™n ng√†nh CNTT, c∆° kh√≠.' },
    { id:'u2', name:'ƒê·∫°i h·ªçc Kinh t·∫ø Y', region:'H√† N·ªôi', type:'public', fee:10000, rank:18, majors:['biz','fin','law'], score:[25.5,25.0,24.5], desc:'Tr∆∞·ªùng top v·ªÅ kinh t·∫ø, qu·∫£n tr·ªã, marketing.' },
    { id:'u3', name:'Tr∆∞·ªùng ƒê·∫°i h·ªçc T∆∞ th·ª•c Z', region:'ƒê√† N·∫µng', type:'private', fee:32000, rank:150, majors:['design','hotel','biz'], score:[null,null,null], desc:'Tr∆∞·ªùng t∆∞ th·ª•c hi·ªán ƒë·∫°i, nhi·ªÅu ch∆∞∆°ng tr√¨nh li√™n k·∫øt.' },
    { id:'u4', name:'H·ªçc vi·ªán C√¥ng ngh·ªá Th√¥ng tin A', region:'H·ªì Ch√≠ Minh', type:'public', fee:15000, rank:40, majors:['cs','it','se'], score:[26.0,25.5,25.2], desc:'Chuy√™n s√¢u v·ªÅ CNTT v√† d·ªØ li·ªáu.' },
    { id:'u5', name:'ƒê·∫°i h·ªçc Y D∆∞·ª£c TP', region:'H√† N·ªôi', type:'public', fee:22000, rank:10, majors:['med'], score:[28.0], desc:'Tr∆∞·ªùng y h√†ng ƒë·∫ßu v·ªõi h·ªá th·ªëng b·ªánh vi·ªán li√™n k·∫øt.' },
    { id:'u6', name:'ƒê·∫°i h·ªçc Ki·∫øn tr√∫c Q', region:'H·ªì Ch√≠ Minh', type:'public', fee:12000, rank:70, majors:['arch','design'], score:[24.5,24.0], desc:'N·ªïi ti·∫øng v·ªÅ ki·∫øn tr√∫c v√† thi·∫øt k·∫ø.' },
    { id:'u7', name:'ƒê·∫°i h·ªçc N√¥ng L√¢m', region:'L√¢m ƒê·ªìng', type:'public', fee:8000, rank:120, majors:['agr','env'], score:[20.5,20.0], desc:'Chuy√™n ng√†nh n√¥ng nghi·ªáp v√† m√¥i tr∆∞·ªùng.' },
    { id:'u8', name:'Tr∆∞·ªùng Qu·ªëc t·∫ø D', region:'H·ªì Ch√≠ Minh', type:'private', fee:45000, rank:200, majors:['cs','design','biz'], score:[null], desc:'Ch∆∞∆°ng tr√¨nh qu·ªëc t·∫ø, h·ªçc ph√≠ cao.' },
    { id:'u9', name:'ƒê·∫°i h·ªçc S∆∞ ph·∫°m E', region:'H√† N·ªôi', type:'public', fee:9000, rank:60, majors:['edu','psych'], score:[22.0,22.5], desc:'ƒê√†o t·∫°o gi√°o vi√™n v√† chuy√™n vi√™n t√¢m l√Ω.' },
    { id:'u10', name:'H·ªçc vi·ªán Du l·ªãch F', region:'ƒê√† N·∫µng', type:'public', fee:9500, rank:180, majors:['hotel'], score:[null], desc:'Tr∆∞·ªùng chuy√™n ng√†nh du l·ªãch & kh√°ch s·∫°n.' },
    // ... th√™m nhi·ªÅu tr∆∞·ªùng ƒë·ªÉ demo (t·∫°o kho·∫£ng 30-50 tr∆∞·ªùng n·∫øu mu·ªën)
  ];

  const SAMPLE_BLOGS = [
    { id:'b1', title:'C√°ch ch·ªçn ng√†nh ph√π h·ª£p', excerpt:'H∆∞·ªõng d·∫´n 5 b∆∞·ªõc ch·ªçn ng√†nh theo s·ªü th√≠ch v√† t∆∞∆°ng lai' },
    { id:'b2', title:'C√°c nh√≥m ng√†nh hot 2025‚Äì2030', excerpt:'AI, d·ªØ li·ªáu, nƒÉng l∆∞·ª£ng xanh, chƒÉm s√≥c s·ª©c kh·ªèe...' },
    { id:'b3', title:'H·ªçc l·ª±c trung b√¨nh n√™n ch·ªçn ng√†nh n√†o?', excerpt:'G·ª£i √Ω th·ª±c t·∫ø cho h·ªçc sinh h·ªçc l·ª±c trung b√¨nh' },
    { id:'b4', title:'H∆∞·ªõng d·∫´n x√©t tuy·ªÉn ƒë·∫°i h·ªçc', excerpt:'C·∫≠p nh·∫≠t ph∆∞∆°ng th·ª©c x√©t tuy·ªÉn, ƒëi·ªÉm chu·∫©n, v√† h·ªì s∆°' }
  ];

  // ---------------------------
  // RIASEC Questions (60 explicit questions)
  // Each question belongs to one of R,I,A,S,E,C groups
  // ---------------------------
  const QUESTIONS = [
    { id:1, axis:'R', text:'B·∫°n th√≠ch l√†m vi·ªác th·ª±c t·∫ø, s·ª≠a ch·ªØa ho·∫∑c l·∫Øp r√°p m√°y m√≥c?' },
    { id:2, axis:'R', text:'B·∫°n th√≠ch ho·∫°t ƒë·ªông ngo√†i tr·ªùi, v∆∞·ªùn t∆∞·ª£c, l√†m vi·ªác v·ªõi ƒë·∫•t?' },
    { id:3, axis:'R', text:'B·∫°n th√≠ch t·∫°o, x√¢y d·ª±ng v·∫≠t th·ªÉ b·∫±ng tay (v√≠ d·ª•: ƒë·ªì th·ªß c√¥ng, m√¥ h√¨nh)?' },
    { id:4, axis:'R', text:'B·∫°n c·∫£m th·∫•y h·ª©ng th√∫ khi t√¨m hi·ªÉu c∆° ch·∫ø ho·∫°t ƒë·ªông c·ªßa m√°y m√≥c?' },
    { id:5, axis:'R', text:'B·∫°n th√≠ch ƒë·ªçc t√†i li·ªáu k·ªπ thu·∫≠t v√† h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng c√°c thi·∫øt b·ªã?' },

    { id:6, axis:'I', text:'B·∫°n th√≠ch gi·∫£i th√≠ch c√°c hi·ªán t∆∞·ª£ng t·ª± nhi√™n b·∫±ng logic v√† s·ªë li·ªáu?' },
    { id:7, axis:'I', text:'B·∫°n th√≠ch l√†m th√≠ nghi·ªám, ph√¢n t√≠ch, ho·∫∑c nghi√™n c·ª©u?' },
    { id:8, axis:'I', text:'B·∫°n th·∫•y th√≠ch th√∫ v·ªõi vi·ªác ƒë·ªçc s√°ch chuy√™n ng√†nh v√† b√°o khoa h·ªçc?' },
    { id:9, axis:'I', text:'B·∫°n th√≠ch gi·∫£i to√°n/ph√¢n t√≠ch khi g·∫∑p v·∫•n ƒë·ªÅ ph·ª©c t·∫°p?' },
    { id:10, axis:'I', text:'B·∫°n nghi√™ng v·ªÅ ho·∫°t ƒë·ªông quan s√°t, thu th·∫≠p d·ªØ li·ªáu v√† suy lu·∫≠n?' },

    { id:11, axis:'A', text:'B·∫°n th√≠ch s√°ng t√°c, v·∫Ω, hay thi·∫øt k·∫ø h√¨nh ·∫£nh?' },
    { id:12, axis:'A', text:'B·∫°n c·∫£m th·∫•y tho·∫£i m√°i khi bi·ªÉu di·ªÖn, tr√¨nh di·ªÖn tr∆∞·ªõc ng∆∞·ªùi kh√°c?' },
    { id:13, axis:'A', text:'B·∫°n th√≠ch vi·∫øt s√°ng t·∫°o, l√†m n·ªôi dung ho·∫∑c media?' },
    { id:14, axis:'A', text:'B·∫°n c√≥ √≥c th·∫©m m·ªπ, quan t√¢m t·ªõi m√†u s·∫Øc v√† b·ªë c·ª•c?' },
    { id:15, axis:'A', text:'B·∫°n th∆∞·ªùng t√¨m ki·∫øm gi·∫£i ph√°p s√°ng t·∫°o cho v·∫•n ƒë·ªÅ?' },

    { id:16, axis:'S', text:'B·∫°n th√≠ch gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c, c·∫£m gi√°c th·ªèa m√£n khi h·ªó tr·ª£?' },
    { id:17, axis:'S', text:'B·∫°n nghƒ© m√¨nh ph√π h·ª£p v·ªõi c√¥ng vi·ªác t∆∞ v·∫•n, chƒÉm s√≥c hay gi·∫£ng d·∫°y?' },
    { id:18, axis:'S', text:'B·∫°n gi·ªèi l·∫Øng nghe v√† l√†m vi·ªác v·ªõi c·∫£m x√∫c c·ªßa ng∆∞·ªùi kh√°c?' },
    { id:19, axis:'S', text:'B·∫°n tham gia c√°c ho·∫°t ƒë·ªông t√¨nh nguy·ªán hay h·ªó tr·ª£ c·ªông ƒë·ªìng?' },
    { id:20, axis:'S', text:'B·∫°n th√≠ch c√¥ng vi·ªác c·∫ßn s·ª± t·ªâ m·ªâ trong chƒÉm s√≥c con ng∆∞·ªùi?' },

    { id:21, axis:'E', text:'B·∫°n th√≠ch thuy·∫øt ph·ª•c, b√°n h√†ng ho·∫∑c l√£nh ƒë·∫°o m·ªôt nh√≥m?' },
    { id:22, axis:'E', text:'B·∫°n th·∫•y h√†o h·ª©ng khi ƒë·ª©ng tr∆∞·ªõc ƒë√°m ƒë√¥ng thuy·∫øt tr√¨nh?' },
    { id:23, axis:'E', text:'B·∫°n th√≠ch t·ªï ch·ª©c s·ª± ki·ªán, x√¢y d·ª±ng m·ªëi quan h·ªá v√† networking?' },
    { id:24, axis:'E', text:'B·∫°n c·∫£m th·∫•y t·ª± tin trong th∆∞∆°ng l∆∞·ª£ng v√† ƒë√†m ph√°n?' },
    { id:25, axis:'E', text:'B·∫°n th√≠ch c√¥ng vi·ªác mang t√≠nh doanh nghi·ªáp v√† s√°ng l·∫≠p?' },

    { id:26, axis:'C', text:'B·∫°n th√≠ch l√†m vi·ªác v·ªõi d·ªØ li·ªáu, m√°y t√≠nh, h·ªá th·ªëng th√¥ng tin?' },
    { id:27, axis:'C', text:'B·∫°n c·∫£m th·∫•y th√≠ch th√∫ khi l·∫≠p tr√¨nh, s·∫Øp x·∫øp quy tr√¨nh?' },
    { id:28, axis:'C', text:'B·∫°n c√≥ kh·∫£ nƒÉng l√†m vi·ªác ch√≠nh x√°c, hi·ªÉu quy t·∫Øc v√† th·ªß t·ª•c?' },
    { id:29, axis:'C', text:'B·∫°n th√≠ch t·ªëi ∆∞u ho√°, ph√¢n lo·∫°i v√† x·ª≠ l√Ω th√¥ng tin?' },
    { id:30, axis:'C', text:'B·∫°n th·∫•y vui khi thi·∫øt k·∫ø h·ªá th·ªëng l√†m vi·ªác ho·∫∑c quy tr√¨nh?' },

    // Repeat pattern to make 60 questions, rotate axes
    { id:31, axis:'R', text:'B·∫°n th√≠ch c√°c c√¥ng vi·ªác s·ª≠ d·ª•ng ƒë√¥i tay, ki·ªÉm so√°t v·∫≠t li·ªáu?' },
    { id:32, axis:'I', text:'B·∫°n c√≥ h·ª©ng th√∫ v·ªõi nghi√™n c·ª©u l√Ω thuy·∫øt v√† ƒë·ªçc b√°o c√°o chuy√™n m√¥n?' },
    { id:33, axis:'A', text:'B·∫°n th√≠ch l√†m video, ch·ªânh s·ª≠a h√¨nh ·∫£nh hay nhi·∫øp ·∫£nh?' },
    { id:34, axis:'S', text:'B·∫°n ƒëang c√≥ h·ª©ng th√∫ v·ªõi c√¥ng vi·ªác h·ªó tr·ª£ tinh th·∫ßn v√† t∆∞ v·∫•n?' },
    { id:35, axis:'E', text:'B·∫°n hay ƒë·∫£m nh·∫≠n vai tr√≤ l√£nh ƒë·∫°o trong c√°c ho·∫°t ƒë·ªông t·∫≠p th·ªÉ?' },
    { id:36, axis:'C', text:'B·∫°n th√≠ch m√¥ t·∫£ quy tr√¨nh b·∫±ng c√°c bi·ªÉu ƒë·ªì v√† thu·∫≠t to√°n?' },
    { id:37, axis:'R', text:'B·∫°n th√≠ch tham gia c√°c ho·∫°t ƒë·ªông k·ªπ thu·∫≠t, s·ª≠a ch·ªØa t·∫°i nh√†?' },
    { id:38, axis:'I', text:'B·∫°n th√≠ch gi·∫£i quy·∫øt b√†i to√°n ph·ª©c t·∫°p b·∫±ng c√¥ng th·ª©c?' },
    { id:39, axis:'A', text:'B·∫°n th∆∞·ªùng t√¨m ki·∫øm c∆° h·ªôi ƒë·ªÉ th·ªÉ hi·ªán s·ª± s√°ng t·∫°o c√° nh√¢n?' },
    { id:40, axis:'S', text:'B·∫°n th∆∞·ªùng ch·ªß ƒë·ªông gi√∫p ƒë·ª° b·∫°n b√® khi h·ªç g·∫∑p kh√≥ khƒÉn?' },
    { id:41, axis:'E', text:'B·∫°n th√≠ch c√¥ng vi·ªác c·∫ßn giao ti·∫øp nhi·ªÅu, g·∫∑p g·ª° ƒë·ªëi t√°c?' },
    { id:42, axis:'C', text:'B·∫°n c√≥ kh·∫£ nƒÉng t·∫≠p trung cao khi l√†m vi·ªác th·ªß c√¥ng, chi ti·∫øt?' },
    { id:43, axis:'R', text:'B·∫°n tho·∫£i m√°i v·ªõi c√°c c√¥ng vi·ªác m√¥i tr∆∞·ªùng th·ª±c t·∫ø, di chuy·ªÉn nhi·ªÅu?' },
    { id:44, axis:'I', text:'B·∫°n c√≥ xu h∆∞·ªõng ƒë·∫∑t nhi·ªÅu c√¢u h·ªèi ƒë·ªÉ hi·ªÉu s√¢u m·ªôt v·∫•n ƒë·ªÅ?' },
    { id:45, axis:'A', text:'B·∫°n th√≠ch tham gia workshop s√°ng t·∫°o ho·∫∑c d·ª± √°n ngh·ªá thu·∫≠t?' },
    { id:46, axis:'S', text:'B·∫°n th·∫•y h√†i l√≤ng khi h∆∞·ªõng d·∫´n, d·∫°y ng∆∞·ªùi kh√°c l√†m ƒëi·ªÅu g√¨ ƒë√≥?' },
    { id:47, axis:'E', text:'B·∫°n th√≠ch n·∫Øm quy·ªÅn ƒëi·ªÅu ph·ªëi ho·∫°t ƒë·ªông nh√≥m, ph√¢n c√¥ng nhi·ªám v·ª•?' },
    { id:48, axis:'C', text:'B·∫°n th√≠ch l√†m b√°o c√°o, qu·∫£n l√Ω h·ªì s∆°, ki·ªÉm tra t√≠nh ch√≠nh x√°c?' },
    { id:49, axis:'R', text:'B·∫°n th∆∞·ªùng l√†m t·ªët c√°c c√¥ng vi·ªác li√™n quan t·ªõi d·ª•ng c·ª• v√† m√°y m√≥c?' },
    { id:50, axis:'I', text:'B·∫°n quan t√¢m t·ªõi vi·ªác c·∫≠p nh·∫≠t ki·∫øn th·ª©c chuy√™n m√¥n th∆∞·ªùng xuy√™n?' },
    { id:51, axis:'A', text:'B·∫°n c·∫£m th·∫•y nƒÉng l∆∞·ª£ng khi tham gia c√°c d·ª± √°n s√°ng t·∫°o?' },
    { id:52, axis:'S', text:'B·∫°n c√≥ kh·∫£ nƒÉng ƒë·ªìng c·∫£m, x√¢y d·ª±ng m·ªëi quan h·ªá b·ªÅn v·ªØng?' },
    { id:53, axis:'E', text:'B·∫°n th√≠ch ph√°t tri·ªÉn √Ω t∆∞·ªüng kinh doanh v√† ƒë∆∞a n√≥ v√†o th·ª±c t·∫ø?' },
    { id:54, axis:'C', text:'B·∫°n th√≠ch t·ªï ch·ª©c c√¥ng vi·ªác theo tr√¨nh t·ª±, vi·ªác n√†o tr∆∞·ªõc vi·ªác n√†o sau?' },
    { id:55, axis:'R', text:'B·∫°n t·ª± tin khi d√πng thi·∫øt b·ªã c∆° kh√≠ ho·∫∑c c√¥ng c·ª• tay?' },
    { id:56, axis:'I', text:'B·∫°n ƒë∆∞·ª£c truy·ªÅn c·∫£m h·ª©ng b·ªüi c√°c l√Ω thuy·∫øt v√† m√¥ h√¨nh nghi√™n c·ª©u?' },
    { id:57, axis:'A', text:'B·∫°n th√≠ch th·ª≠ nghi·ªám phong c√°ch ngh·ªá thu·∫≠t m·ªõi, kh√°m ph√° h√¨nh th·ª©c?' },
    { id:58, axis:'S', text:'B·∫°n c·∫£m th·∫•y b·∫£n th√¢n ph√π h·ª£p v·ªõi ngh·ªÅ c√≥ t√≠nh c·ªông ƒë·ªìng?' },
    { id:59, axis:'E', text:'B·∫°n ch·ªãu ƒë∆∞·ª£c √°p l·ª±c khi ph·∫£i c·∫°nh tranh, c·ªë g·∫Øng ƒë·∫°t m·ª•c ti√™u?' },
    { id:60, axis:'C', text:'B·∫°n th·∫•y h·ª©ng th√∫ v·ªõi vi·ªác t·∫°o v√† duy tr√¨ c√°c h·ªá th·ªëng hi·ªáu qu·∫£?' }
  ];

  // ---------------------------
  // DB Initialization: create or load from localStorage
  // ---------------------------
  function initDB(){
    const db = loadDB();
    if(!db || !db.majors){
      const newdb = {
        majors: SAMPLE_MAJORS,
        schools: SAMPLE_SCHOOLS,
        blogs: SAMPLE_BLOGS,
        tests: [],   // l∆∞u k·∫øt qu·∫£ test ng∆∞·ªùi d√πng
        users: []
      };
      saveDB(newdb);
      return newdb;
    }
    // ensure required collections exist
    if(!db.majors) db.majors = SAMPLE_MAJORS;
    if(!db.schools) db.schools = SAMPLE_SCHOOLS;
    if(!db.blogs) db.blogs = SAMPLE_BLOGS;
    if(!db.tests) db.tests = [];
    if(!db.users) db.users = [];
    saveDB(db);
    return db;
  }
  let DB = initDB();

  // ---------------------------
  // Populate UI: majors, schools, blogs, filters
  // ---------------------------
  function populateMajors(){
    const wrap = el('majorList'); wrap.innerHTML = '';
    DB.majors.forEach(m=>{
      const d = document.createElement('div'); d.className='card';
      d.innerHTML = `<h3>${m.name}</h3>
        <p style="margin:6px 0">${m.desc}</p>
        <p class="small"><strong>K·ªπ nƒÉng:</strong> ${m.skills.join(', ')}</p>
        <p class="small"><strong>C∆° h·ªôi:</strong> ${m.jobs.join(', ')}</p>
        <div style="margin-top:8px"><button class="btn" onclick="showMajor('${m.id}')">Chi ti·∫øt</button></div>`;
      wrap.appendChild(d);
    });
  }

  function populateSchools(){
    const wrap = el('schoolList'); wrap.innerHTML = '';
    DB.schools.forEach(s=>{
      const d = document.createElement('div'); d.className='card';
      d.style.marginBottom='10px';
      d.innerHTML = `<div style="display:flex;align-items:center;gap:12px;justify-content:space-between">
        <div>
          <h3 style="margin:0">${s.name}</h3>
          <div class="small">${s.region} ‚Ä¢ ${s.type==='public'?'C√¥ng l·∫≠p':'T∆∞ th·ª•c'} ‚Ä¢ H·ªçc ph√≠: ${s.fee? s.fee+'K VND/nƒÉm':'‚Äî'}</div>
        </div>
        <div class="small">X·∫øp h·∫°ng: ${s.rank}</div>
      </div>
      <p style="margin:8px 0">${s.desc}</p>
      <p class="small"><strong>Ng√†nh:</strong> ${s.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}</p>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" onclick="openSchool('${s.id}')">Chi ti·∫øt</button>
        <button class="btn" onclick="addCompare('${s.id}')">So s√°nh</button>
        <button class="btn" onclick="saveFavorite('${s.id}')">L∆∞u</button>
      </div>`;
      wrap.appendChild(d);
    });
    // fill compare selects
    const cmpA = el('cmpA'); const cmpB = el('cmpB');
    cmpA.innerHTML = '<option value=\"\">-- Ch·ªçn tr∆∞·ªùng A --</option>';
    cmpB.innerHTML = '<option value=\"\">-- Ch·ªçn tr∆∞·ªùng B --</option>';
    DB.schools.forEach(s=>{ const o1=document.createElement('option'); o1.value=s.id; o1.textContent=s.name; cmpA.appendChild(o1); const o2=document.createElement('option'); o2.value=s.id; o2.textContent=s.name; cmpB.appendChild(o2); });
    // fill region filter
    const regions = Array.from(new Set(DB.schools.map(s=>s.region))).sort();
    const filterRegion = el('filterRegion'); filterRegion.innerHTML = '<option value=\"\">T·∫•t c·∫£ t·ªânh/th√†nh</option>';
    regions.forEach(r=>{ const o=document.createElement('option'); o.value=r; o.textContent=r; filterRegion.appendChild(o) });
  }

  function populateBlogs(){
    const wrap = el('blogList'); wrap.innerHTML='';
    DB.blogs.forEach(b=>{
      const div=document.createElement('div'); div.className='card';
      div.innerHTML = `<h3>${b.title}</h3><p>${b.excerpt}</p><div style="margin-top:8px"><a href="#" class="btn" onclick="openBlog('${b.id}')">ƒê·ªçc ti·∫øp</a></div>`;
      wrap.appendChild(div);
    });
  }

  function populateSkillFilter(){
    const sel = el('filterSkill'); sel.innerHTML='<option value=\"\">L·ªçc theo k·ªπ nƒÉng (t·∫•t c·∫£)</option>';
    const skills = Array.from(new Set(DB.majors.flatMap(m=>m.skills))).sort();
    skills.forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=s; sel.appendChild(o) });
  }

  // Open major detail
  function showMajor(id){
    const m = DB.majors.find(x=>x.id===id);
    if(!m) return alert('Kh√¥ng t√¨m th·∫•y ng√†nh');
    alert(`${m.name}\n\nM√¥ t·∫£: ${m.desc}\nK·ªπ nƒÉng: ${m.skills.join(', ')}\nC∆° h·ªôi: ${m.jobs.join(', ')}\nNh√≥m RIASEC: ${m.groups.join(', ')}`);
  }

  // Open school
  function openSchool(id){
    const s = DB.schools.find(x=>x.id===id);
    if(!s) return alert('Kh√¥ng t√¨m th·∫•y tr∆∞·ªùng');
    alert(`${s.name}\n\n${s.desc}\n\nNg√†nh: ${s.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}\nH·ªçc ph√≠: ${s.fee? s.fee+'K VND/nƒÉm':'‚Äî'}\nƒêi·ªÉm chu·∫©n (n·∫øu c√≥): ${s.score? s.score.join(', '):'‚Äî'}`);
  }

  // Save favorite
  function saveFavorite(id){
    const db = loadDB();
    db.favorites = db.favorites || [];
    if(!db.favorites.includes(id)) db.favorites.push(id);
    saveDB(db);
    alert('ƒê√£ l∆∞u v√†o danh s√°ch y√™u th√≠ch!');
  }

  // Add compare
  function addCompare(id){
    const cmpA = el('cmpA'), cmpB = el('cmpB');
    if(!cmpA.value) cmpA.value = id;
    else if(!cmpB.value && cmpA.value !== id) cmpB.value = id;
    else cmpB.value = id;
  }

  // ---------------------------
  // TEST UI logic
  // ---------------------------
  let answers = new Array(QUESTIONS.length).fill(3); // trung b√¨nh m·∫∑c ƒë·ªãnh 3
  let qIndex = 0;

  function renderQuestion(){
    const q = QUESTIONS[qIndex];
    el('qCount').textContent = `C√¢u ${qIndex+1} / ${QUESTIONS.length}`;
    el('progFill').style.width = `${((qIndex+1)/QUESTIONS.length)*100}%`;
    const wrap = el('qWrap'); wrap.innerHTML = '';
    const qdiv = document.createElement('div'); qdiv.innerHTML = `<div class="question">${q.text}</div>`;
    const opts = document.createElement('div'); opts.className='options';
    for(let i=1;i<=5;i++){
      const b = document.createElement('div'); b.className='opt'; b.textContent = i + (i===1? ' ‚Äî Kh√¥ng' : i===5? ' ‚Äî R·∫•t' : '');
      b.dataset.val = i;
      if(answers[qIndex]===i) b.classList.add('selected');
      b.onclick = ()=>{ answers[qIndex] = i; Array.from(opts.children).forEach(n=>n.classList.remove('selected')); b.classList.add('selected'); updateTestStatus(); };
      opts.appendChild(b);
    }
    qdiv.appendChild(opts);
    wrap.appendChild(qdiv);
  }

  function updateTestStatus(){
    const chosen = answers.filter(a=>a!==null).length;
    el('testStatus').textContent = `${chosen} / ${QUESTIONS.length} c√¢u ƒë√£ tr·∫£ l·ªùi`;
  }

  el('nextQ').addEventListener('click', ()=>{ if(qIndex < QUESTIONS.length-1) qIndex++; renderQuestion(); });
  el('prevQ').addEventListener('click', ()=>{ if(qIndex > 0) qIndex--; renderQuestion(); });

  // finish test: compute RIASEC scores
  function finishTest(){
    // answers length check
    // compute sum per axis
    const scores = {R:0,I:0,A:0,S:0,E:0,C:0};
    for(let i=0;i<QUESTIONS.length;i++){
      const axis = QUESTIONS[i].axis;
      const val = answers[i] || 0;
      scores[axis] += val;
    }
    // normalize as average
    const avg = {};
    Object.keys(scores).forEach(k=>{ avg[k] = +(scores[k]).toFixed(2) });

    // determine top 3 axes
    const axesSorted = Object.entries(avg).sort((a,b)=>b[1]-a[1]).map(x=>x[0]);
    const primary = axesSorted[0], secondary = axesSorted[1], third = axesSorted[2];

    // map to majors
    const suggestedMajors = DB.majors.filter(m => m.groups.includes(primary) || m.groups.includes(secondary)).slice(0,6);

    // prepare display
    const summary = el('resultSummary');
    summary.innerHTML = `<div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
      <div><strong>ƒêi·ªÉm RIASEC (t·ªïng theo tr·ª•c):</strong> ${JSON.stringify(avg)}</div>
      <div class="small">Nh√≥m ch√≠nh: <strong>${primary}</strong> ‚Äî Ph·ª•: ${secondary}, ${third}</div>
    </div>
    <hr />
    <div><strong>G·ª£i √Ω ng√†nh h√†ng ƒë·∫ßu:</strong></div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px">${suggestedMajors.map(m=>`<div class="card"><strong>${m.name}</strong><div class="small">${m.desc}</div></div>`).join('')}</div>
    `;

    el('resultArea').style.display='block';
    // save test result to DB
    const db = loadDB();
    db.tests = db.tests || [];
    const testRecord = {
      id: uid('test'),
      date: (new Date()).toISOString(),
      scores: avg,
      primary, secondary, third,
      answers
    };
    db.tests.push(testRecord);
    saveDB(db);
    DB = db;
    populateMajors();
  }

  // Buttons
  el('finishTest').addEventListener('click', ()=> finishTest());
  el('goTest').addEventListener('click', ()=> { location.hash='#test'; qIndex=0; renderQuestion(); });
  el('startBtn').addEventListener('click', ()=> { location.hash='#test'; qIndex=0; renderQuestion(); });

  // initial render
  renderQuestion();
  updateTestStatus();
  populateMajors();
  populateSchools();
  populateBlogs();
  populateSkillFilter();

  // Suggest majors button
  el('suggestMajors').addEventListener('click', ()=>{
    location.hash='#majors';
    window.scrollTo({top:document.querySelector('#majors').offsetTop - 40, behavior:'smooth'});
  });

  // Suggest schools button (simple ranking by matching majors)
  el('suggestSchools').addEventListener('click', ()=>{
    // use last test
    const db = loadDB();
    const lastTest = (db.tests && db.tests.length)? db.tests[db.tests.length-1] : null;
    if(!lastTest){ alert('B·∫°n ch∆∞a l√†m b√†i test. Vui l√≤ng ho√†n th√†nh b√†i test tr∆∞·ªõc.'); return; }
    // primary axis
    const primary = lastTest.primary;
    // majors that match primary
    const matchedMajors = DB.majors.filter(m=>m.groups.includes(primary)).map(m=>m.id);
    // rank schools by number of matched majors and lower fee and better rank
    const scored = DB.schools.map(s=>{
      const common = s.majors.filter(m=>matchedMajors.includes(m)).length;
      const score = common * 100 - (s.fee || 0) - (s.rank || 999);
      return {...s, scoreRank: score, common}
    }).sort((a,b)=>b.scoreRank - a.scoreRank);
    const top5 = scored.slice(0,5);
    // show list
    const wrap = el('schoolList');
    wrap.innerHTML = top5.map(s=>`<div class="card"><h3>${s.name}</h3><div class="small">${s.region} ‚Ä¢ ${s.type==='public'?'C√¥ng l·∫≠p':'T∆∞ th·ª•c'} ‚Ä¢ H·ªçc ph√≠: ${s.fee? s.fee+'K':'‚Äî'}</div><p style="margin:6px 0">${s.desc}</p><div class="small"><strong>Ng√†nh ph√π h·ª£p:</strong> ${s.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}</div></div>`).join('');
    location.hash='#schools';
  });

  // Export result JSON
  el('exportResult').addEventListener('click', ()=>{
    const db = loadDB();
    const lastTest = db.tests && db.tests.length? db.tests[db.tests.length-1] : null;
    if(!lastTest) return alert('Kh√¥ng c√≥ k·∫øt qu·∫£ ƒë·ªÉ xu·∫•t.');
    const blob = new Blob([JSON.stringify(lastTest,null,2)],{type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download = `unimatcher_test_${lastTest.id}.json`; a.click();
  });

  // ---------------------------
  // Filters & Search schools
  // ---------------------------
  el('applyFilters').addEventListener('click', ()=>{
    const region = el('filterRegion').value;
    const type = el('filterType').value;
    const fee = el('filterFee').value;
    const rank = el('filterRank').value;
    const q = el('schoolSearch').value.trim().toLowerCase();

    let res = DB.schools.slice();
    if(region) res = res.filter(s=>s.region===region);
    if(type) res = res.filter(s=>s.type===type);
    if(fee){
      if(fee==='lt10000') res = res.filter(s=>s.fee && s.fee < 10000);
      if(fee==='10000-30000') res = res.filter(s=>s.fee && s.fee >= 10000 && s.fee <= 30000);
      if(fee==='gt30000') res = res.filter(s=>s.fee && s.fee > 30000);
    }
    if(rank){
      if(rank==='top50') res = res.filter(s=>s.rank && s.rank <= 50);
      if(rank==='top200') res = res.filter(s=>s.rank && s.rank <= 200);
    }
    if(q){
      res = res.filter(s => s.name.toLowerCase().includes(q) || s.majors.some(m=> (DB.majors.find(mm=>mm.id===m)||{name:''}).name.toLowerCase().includes(q)));
    }

    const wrap = el('schoolList');
    if(res.length===0) wrap.innerHTML = '<p>Kh√¥ng t√¨m th·∫•y tr∆∞·ªùng ph√π h·ª£p.</p>';
    else wrap.innerHTML = res.map(s=>`<div class="card"><h3>${s.name}</h3><div class="small">${s.region} ‚Ä¢ ${s.type==='public'?'C√¥ng l·∫≠p':'T∆∞ th·ª•c'} ‚Ä¢ H·ªçc ph√≠: ${s.fee? s.fee+'K':'‚Äî'}</div><p style="margin:6px 0">${s.desc}</p><div class="small"><strong>Ng√†nh:</strong> ${s.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}</div></div>`).join('');
  });

  el('resetFilters').addEventListener('click', ()=>{
    el('filterRegion').value=''; el('filterType').value=''; el('filterFee').value=''; el('filterRank').value=''; el('schoolSearch').value=''; populateSchools();
  });

  // quick search
  el('gotoSchools').addEventListener('click', ()=>{ location.hash='#schools'; window.scrollTo({top:document.querySelector('#schools').offsetTop-30, behavior:'smooth'})});
  el('quickSearch').addEventListener('keydown', (e)=>{ if(e.key==='Enter') { el('schoolSearch').value = e.target.value; el('applyFilters').click(); } });

  // ---------------------------
  // Compare logic
  // ---------------------------
  el('doCompare').addEventListener('click', ()=>{
    const aId = el('cmpA').value; const bId = el('cmpB').value;
    if(!aId || !bId) return alert('Ch·ªçn 2 tr∆∞·ªùng ƒë·ªÉ so s√°nh.');
    const a = DB.schools.find(s=>s.id===aId); const b = DB.schools.find(s=>s.id===bId);
    // metrics: avg score, fee, rank, number of matching majors with sample user's primary majors
    const html = `<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="card"><h3>${a.name}</h3><p class="small">${a.region} ‚Ä¢ ${a.type==='public'?'C√¥ng l·∫≠p':'T∆∞ th·ª•c'}</p>
      <p><strong>H·ªçc ph√≠:</strong> ${a.fee? a.fee+'K VNƒê/nƒÉm':'‚Äî'}</p>
      <p><strong>ƒêi·ªÉm chu·∫©n (nƒÉm):</strong> ${a.score? a.score.join(', '): '‚Äî'}</p>
      <p><strong>Ng√†nh:</strong> ${a.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}</p></div>
      <div class="card"><h3>${b.name}</h3><p class="small">${b.region} ‚Ä¢ ${b.type==='public'?'C√¥ng l·∫≠p':'T∆∞ th·ª•c'}</p>
      <p><strong>H·ªçc ph√≠:</strong> ${b.fee? b.fee+'K VNƒê/nƒÉm':'‚Äî'}</p>
      <p><strong>ƒêi·ªÉm chu·∫©n (nƒÉm):</strong> ${b.score? b.score.join(', '): '‚Äî'}</p>
      <p><strong>Ng√†nh:</strong> ${b.majors.map(mid=> (DB.majors.find(mm=>mm.id===mid)||{name:mid}).name).join(', ')}</p></div>
    </div>
    <hr />
    <div style="display:flex;gap:12px;align-items:center">
      <div style="flex:1"><strong>So s√°nh h·ªçc ph√≠</strong><div class="bar" style="margin-top:6px"><i style="width:${Math.min(100, (a.fee||0)/Math.max(1,(a.fee||0 + b.fee||0))*100)}%"></i></div><div class="small">${a.fee? a.fee+'K' : '‚Äî'}</div></div>
      <div style="flex:1"><strong>So s√°nh h·ªçc ph√≠</strong><div class="bar" style="margin-top:6px"><i style="width:${Math.min(100, (b.fee||0)/Math.max(1,(a.fee||0 + b.fee||0))*100)}%"></i></div><div class="small">${b.fee? b.fee+'K' : '‚Äî'}</div></div>
    </div>`;
    el('compareResult').innerHTML = html;
    location.hash='#compare';
  });

  el('clearCompare').addEventListener('click', ()=>{ el('cmpA').value=''; el('cmpB').value=''; el('compareResult').innerHTML=''; });

  // ---------------------------
  // Blog open
  // ---------------------------
  function openBlog(id){
    const b = DB.blogs.find(x=>x.id===id);
    if(!b) return alert('Kh√¥ng t√¨m th·∫•y b√†i vi·∫øt.');
    alert(`${b.title}\n\n${b.excerpt}\n\n(ƒê√¢y l√† b·∫£n demo. B·∫°n c√≥ th·ªÉ th√™m n·ªôi dung chi ti·∫øt trong Admin.)`);
  }
  window.openBlog = openBlog;

  // ---------------------------
  // Contact form (demo)
  // ---------------------------
  el('sendContact').addEventListener('click', ()=>{
    const name = el('cname').value.trim(); const email = el('cemail').value.trim(); const message = el('cmessage').value.trim();
    if(!name || !email || !message) return alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin.');
    // store in db -> messages
    const db = loadDB(); db.messages = db.messages || []; db.messages.push({id:uid('msg'), name, email, message, date:(new Date()).toISOString()}); saveDB(db); DB=db;
    alert('C·∫£m ∆°n! Ch√∫ng t√¥i ƒë√£ nh·∫≠n ƒë∆∞·ª£c c√¢u h·ªèi.'); el('contactForm').reset();
  });

  // ---------------------------
  // Admin: Export / Import / Seed / Clear
  // ---------------------------
  el('exportData').addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(loadDB(), null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='unimatcher_data_export.json'; a.click();
  });

  el('importData').addEventListener('click', ()=>{ el('importFile').click(); });
  el('importFile').addEventListener('change', (ev)=>{
    const f = ev.target.files[0]; if(!f) return;
    const reader = new FileReader(); reader.onload = e => {
      try{
        const obj = JSON.parse(e.target.result);
        if(!obj.majors || !obj.schools) return alert('File kh√¥ng h·ª£p l·ªá (thi·∫øu majors ho·∫∑c schools).');
        saveDB(obj); DB = loadDB(); populateMajors(); populateSchools(); populateBlogs(); alert('Nh·∫≠p d·ªØ li·ªáu th√†nh c√¥ng.');
      }catch(err){ alert('Kh√¥ng th·ªÉ ƒë·ªçc file: ' + err.message) }
    }; reader.readAsText(f);
  });

  el('seedData').addEventListener('click', ()=>{
    if(!confirm('Seed d·ªØ li·ªáu m·∫´u (s·∫Ω ghi ƒë√® DB hi·ªán t·∫°i)?')) return;
    const newdb = {
      majors: SAMPLE_MAJORS,
      schools: SAMPLE_SCHOOLS,
      blogs: SAMPLE_BLOGS,
      tests: [],
      users: []
    };
    saveDB(newdb); DB = newdb; populateMajors(); populateSchools(); populateBlogs(); alert('Seed d·ªØ li·ªáu ho√†n t·∫•t.');
  });

  el('clearData').addEventListener('click', ()=>{
    if(!confirm('X√≥a to√†n b·ªô d·ªØ li·ªáu demo trong localStorage?')) return;
    localStorage.removeItem('unimatcher_db'); DB = initDB(); populateMajors(); populateSchools(); populateBlogs(); alert('ƒê√£ x√≥a d·ªØ li·ªáu.');
  });

  // download sample data
  el('downloadSample').addEventListener('click', ()=>{
    const sample = {majors: SAMPLE_MAJORS, schools: SAMPLE_SCHOOLS, blogs: SAMPLE_BLOGS};
    const blob = new Blob([JSON.stringify(sample, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='unimatcher_sample_data.json'; a.click();
  });

  // import demo via drag&drop (bonus)
  window.addEventListener('dragover', e=>e.preventDefault()); window.addEventListener('drop', e=>{ e.preventDefault(); });

  // ---------------------------
  // Dark mode toggle
  // ---------------------------
  function applyDark(d){
    if(d){ document.documentElement.classList.add('dark'); localStorage.setItem('um_dark','1'); el('darkToggle').textContent='‚òÄÔ∏è'; }
    else { document.documentElement.classList.remove('dark'); localStorage.removeItem('um_dark'); el('darkToggle').textContent='üåô'; }
  }
  el('darkToggle').addEventListener('click', ()=>{ applyDark(!document.documentElement.classList.contains('dark')); });
  if(localStorage.getItem('um_dark')) applyDark(true);

  // ---------------------------
  // On load - show initial state
  // ---------------------------
  (function initialLoad(){
    populateMajors(); populateSchools(); populateBlogs(); populateSkillFilter();
    // set default demo values for answers (3)
    answers = new Array(QUESTIONS.length).fill(3);
    qIndex = 0;
    renderQuestion();
    // show sample message if DB was empty before
    // console.log('UniMatcher ready.');
  })();

  // expose some functions to global for inline onclicks
  window.showMajor = showMajor;
  window.openSchool = openSchool;
  window.addCompare = addCompare;
  window.saveFavorite = saveFavorite;
  window.renderQuestion = renderQuestion;
  window.finishTest = finishTest;
  window.openBlog = openBlog;

  </script>

  <!-- =========================
       Sample Backend (Node.js + Express + MongoDB)
       (This is a commented block. Copy to server if you want to enable real backend)
       =========================
       
  // server.js
  const express = require('express');
  const mongoose = require('mongoose');
  const cors = require('cors');
  const app = express();
  app.use(cors());
  app.use(express.json());
  mongoose.connect(process.env.MONGO_URI || 'mongodb://localhost:27017/unimatcher', { useNewUrlParser:true, useUnifiedTopology:true })
    .then(()=>console.log('MongoDB connected'))
    .catch(err=>console.error(err));
  const Schema = mongoose.Schema;
  const MajorSchema = new Schema({ id:String, name:String, desc:String, skills:[String], jobs:[String], groups:[String] });
  const SchoolSchema = new Schema({ id:String, name:String, region:String, type:String, fee:Number, rank:Number, majors:[String], score:[Number], desc:String });
  const BlogSchema = new Schema({ id:String, title:String, excerpt:String, content:String });
  const TestSchema = new Schema({ id:String, date:Date, scores:Object, answers:Array });
  const Major = mongoose.model('Major', MajorSchema);
  const School = mongoose.model('School', SchoolSchema);
  const Blog = mongoose.model('Blog', BlogSchema);
  const Test = mongoose.model('Test', TestSchema);
  app.get('/api/majors', async (req,res)=>{ const items = await Major.find(); res.json(items) });
  app.get('/api/schools', async (req,res)=>{ const items = await School.find(); res.json(items) });
  app.post('/api/tests', async (req,res)=>{ const t = await Test.create(req.body); res.json(t) });
  app.listen(process.env.PORT || 4000, ()=>console.log('Server running'));
  
  ========================= -->

</body>
</html>
